<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>GameCre8 — Galaxy Blaster</title>
<style>
  :root{--ui:#fff;--bg:#050813}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--ui);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
  #wrap{position:fixed;inset:0;display:grid;place-items:center}
  canvas{display:block;max-width:100%;max-height:100%;touch-action:none;image-rendering:pixelated}
  .hud{position:fixed;left:0;right:0;top:0;display:flex;justify-content:space-between;gap:8px;padding:10px 12px;pointer-events:none}
  .pill{border:1px solid #2a355a;background:rgba(8,14,32,.55);backdrop-filter:blur(6px);padding:8px 12px;border-radius:999px;font-size:13px}
  .btn{appearance:none;border:1px solid #2a355a;background:linear-gradient(#0a1633,#08122a);color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;pointer-events:auto}
  .overlay{position:fixed;inset:0;display:grid;place-items:center;background:linear-gradient(180deg,rgba(5,8,19,.88),rgba(5,8,19,.7));text-align:center;padding:24px}
  .card{max-width:600px;border:1px solid #2a355a;background:rgba(8,14,32,.45);backdrop-filter:blur(10px);border-radius:16px;padding:18px}
  h1{margin:0 0 8px 0}
  .kpi{font-size:14px;opacity:.9}
  #touch{position:fixed;inset:0;pointer-events:none}
  .pad,.fire{position:absolute;width:95px;height:95px;border-radius:50%;border:1px solid #2a355a;pointer-events:auto}
  .pad{background:rgba(8,14,32,.35);left:16px;bottom:18px}
  .pad::after{content:'‹ ›';position:absolute;inset:0;display:grid;place-items:center;color:#8fb3ff;opacity:.85}
  .fire{background:rgba(32,8,18,.35);right:16px;bottom:18px}
  .fire::after{content:'★';position:absolute;inset:0;display:grid;place-items:center;color:#ff9aad}
  @media (min-width:900px){#touch{display:none}}
</style>
</head>
<body>
  <div id="wrap"><canvas id="c"></canvas></div>

  <div class="hud">
    <div style="display:flex;gap:8px">
      <div class="pill" id="scorePill">Score: 0</div>
      <div class="pill" id="livesPill">♥♥♥</div>
      <div class="pill" id="powerPill">Power: —</div>
    </div>
    <button class="btn" id="pauseBtn">Pause</button>
  </div>

  <div class="overlay" id="start">
    <div class="card">
      <h1>GameCre8 — Galaxy Blaster</h1>
      <p class="kpi">Controls: ←/→ or A/D, Space to fire. Tap on mobile.</p>
      <p class="kpi" id="bestLine"></p>
      <div style="height:10px"></div>
      <button class="btn" id="playBtn">Play Now</button>
    </div>
  </div>

  <div class="overlay" id="gameover" style="display:none">
    <div class="card">
      <h1>Game Over</h1>
      <p class="kpi" id="finalLine"></p>
      <div style="height:10px"></div>
      <button class="btn" id="againBtn">Play Again</button>
    </div>
  </div>

  <div id="touch">
    <div class="pad" id="pad"></div>
    <div class="fire" id="fire"></div>
  </div>

<script>
(() => {
  // ---------- helper: try a list of candidate paths and return first that loads ----------
  function loadFirst(cands){ return new Promise(res=>{ let i=0, img=new Image();
    const tryNext=()=>{ if(i>=cands.length){ res(null); return; }
      img = new Image(); img.decoding='async'; img.crossOrigin='anonymous';
      img.onload=()=>res({img,src:cands[i]}); img.onerror=()=>{ i++; tryNext(); }; img.src=cands[i];
    }; tryNext();
  });}

  // Candidate asset locations (supports /assets, Spritesheet, and your Spritehseet typo)
  const CANDIDATES = {
    player: [
      // /assets (Kenney typical)
      'assets/PNG/playerShip1_blue.png',
      'assets/PNG/Players/playerShip1_blue.png',
      'assets/PNG/playerShip2_orange.png',
      'assets/PNG/playerShip3_red.png',
      // Correct "Spritesheet"
      'assets/Spritesheet/playerShip1_blue.png',
      'assets/Spritesheet/Players/playerShip1_blue.png',
      'Spritesheet/playerShip1_blue.png',
      'Spritesheet/Players/playerShip1_blue.png',
      // Your typo "Spritehseet"
      'assets/Spritehseet/playerShip1_blue.png',
      'assets/Spritehseet/Players/playerShip1_blue.png',
      'Spritehseet/playerShip1_blue.png',
      'Spritehseet/Players/playerShip1_blue.png'
    ],
    enemy: [
      'assets/PNG/Enemies/enemyBlack1.png',
      'assets/PNG/Enemies/enemyBlue1.png',
      'assets/PNG/Enemies/enemyGreen1.png',
      'assets/PNG/Enemies/enemyRed1.png',
      'assets/Spritesheet/Enemies/enemyBlack1.png',
      'assets/Spritesheet/Enemies/enemyBlue1.png',
      'assets/Spritesheet/Enemies/enemyGreen1.png',
      'assets/Spritesheet/Enemies/enemyRed1.png',
      'assets/Spritehseet/Enemies/enemyBlack1.png',
      'assets/Spritehseet/Enemies/enemyBlue1.png',
      'assets/Spritehseet/Enemies/enemyGreen1.png',
      'assets/Spritehseet/Enemies/enemyRed1.png',
      'Spritesheet/Enemies/enemyBlack1.png',
      'Spritehseet/Enemies/enemyBlack1.png'
    ],
    meteor: [
      'assets/PNG/Meteors/meteorBrown_big1.png',
      'assets/PNG/Meteors/meteorGrey_big1.png',
      'assets/PNG/Meteors/meteorBrown_med1.png',
      'assets/PNG/Meteors/meteorGrey_med1.png',
      'assets/Spritesheet/Meteors/meteorBrown_big1.png',
      'assets/Spritesheet/Meteors/meteorGrey_big1.png',
      'assets/Spritesheet/Meteors/meteorBrown_med1.png',
      'assets/Spritesheet/Meteors/meteorGrey_med1.png',
      'assets/Spritehseet/Meteors/meteorBrown_big1.png',
      'assets/Spritehseet/Meteors/meteorGrey_big1.png',
      'assets/Spritehseet/Meteors/meteorBrown_med1.png',
      'assets/Spritehseet/Meteors/meteorGrey_med1.png',
      'Spritesheet/Meteors/meteorBrown_big1.png',
      'Spritehseet/Meteors/meteorBrown_big1.png'
    ],
    bullet: [
      'assets/PNG/Lasers/laserBlue04.png',
      'assets/PNG/Lasers/laserBlue06.png',
      'assets/PNG/Lasers/laserBlue10.png',
      'assets/Spritesheet/Lasers/laserBlue04.png',
      'assets/Spritesheet/Lasers/laserBlue06.png',
      'assets/Spritesheet/Lasers/laserBlue10.png',
      'assets/Spritehseet/Lasers/laserBlue04.png',
      'assets/Spritehseet/Lasers/laserBlue06.png',
      'assets/Spritehseet/Lasers/laserBlue10.png',
      'Spritesheet/Lasers/laserBlue04.png',
      'Spritehseet/Lasers/laserBlue04.png'
    ],
    ebullet: [
      'assets/PNG/Lasers/laserRed02.png',
      'assets/PNG/Lasers/laserRed06.png',
      'assets/Spritesheet/Lasers/laserRed02.png',
      'assets/Spritesheet/Lasers/laserRed06.png',
      'assets/Spritehseet/Lasers/laserRed02.png',
      'assets/Spritehseet/Lasers/laserRed06.png',
      'Spritesheet/Lasers/laserRed02.png',
      'Spritehseet/Lasers/laserRed02.png'
    ],
    bg: [
      'assets/Backgrounds/black.png',
      'assets/Backgrounds/darkPurple.png',
      'assets/Backgrounds/purple.png',
      'assets/Backgrounds/blue.png',
      'Backgrounds/black.png',
      'Backgrounds/darkPurple.png',
      'Backgrounds/purple.png',
      'Backgrounds/blue.png'
    ]
  };

  // ---------- Canvas ----------
  const cv = document.getElementById('c'), cx = cv.getContext('2d');
  const DPR = Math.min(devicePixelRatio||1, 2);
  function fit(){ const w=innerWidth,h=innerHeight; cv.width=(w*DPR)|0; cv.height=(h*DPR)|0; cv.style.width=w+'px'; cv.style.height=h+'px'; }
  addEventListener('resize', fit, {passive:true}); fit();

  // ---------- UI ----------
  const startEl = document.getElementById('start');
  const overEl  = document.getElementById('gameover');
  const playBtn = document.getElementById('playBtn');
  const againBtn= document.getElementById('againBtn');
  const pauseBtn= document.getElementById('pauseBtn');
  const bestLine= document.getElementById('bestLine');
  const finalLine=document.getElementById('finalLine');
  const scoreP  = document.getElementById('scorePill');
  const livesP  = document.getElementById('livesPill');
  const powerP  = document.getElementById('powerPill');

  // ---------- Input ----------
  const keys = {left:false,right:false,shoot:false};
  addEventListener('keydown',e=>{
    if(['ArrowLeft','a','A'].includes(e.key)) keys.left=true;
    if(['ArrowRight','d','D'].includes(e.key)) keys.right=true;
    if(e.code==='Space') keys.shoot=true;
    if(e.key.toLowerCase()==='p') togglePause();
  });
  addEventListener('keyup',e=>{
    if(['ArrowLeft','a','A'].includes(e.key)) keys.left=false;
    if(['ArrowRight','d','D'].includes(e.key)) keys.right=false;
    if(e.code==='Space') keys.shoot=false;
  });

  // Touch pads (mobile)
  let leftTouch=false,rightTouch=false,fireTouch=false;
  function touchify(el,down,up){
    el.addEventListener('pointerdown',ev=>{el.setPointerCapture(ev.pointerId);down(ev);});
    el.addEventListener('pointerup',up); el.addEventListener('pointercancel',up); el.addEventListener('pointerleave',up);
  }
  const pad=document.getElementById('pad'), fire=document.getElementById('fire');
  touchify(pad,(e)=>{
    const r=pad.getBoundingClientRect();
    const onMove=ev=>{const x=ev.clientX-r.left; leftTouch=x<r.width/2; rightTouch=!leftTouch;};
    onMove(e); addEventListener('pointermove',onMove); pad.onpointerup=()=>{leftTouch=rightTouch=false; removeEventListener('pointermove',onMove);};
  },()=>{leftTouch=rightTouch=false;});
  touchify(fire,()=>{fireTouch=true;},()=>{fireTouch=false;});

  // ---------- Assets (auto-select) ----------
  const IMG = {};
  async function loadAssets(){
    for(const r of ['player','enemy','meteor','bullet','ebullet','bg']){
      const found = await loadFirst(CANDIDATES[r]);
      IMG[r] = found ? found.img : null;
    }
  }

  // ---------- RNG ----------
  let seed=(Date.now()%1e6)|0;
  function R(){ seed^=seed<<13; seed^=seed>>17; seed^=seed<<5; return ((seed>>>0)%1e3)/1e3; }

  // ---------- State ----------
  const W=()=>cv.width, H=()=>cv.height;
  const stars=[], bullets=[], enemies=[], ebullets=[], powerups=[], sparks=[];
  const player={x:W()/2,y:H()*0.82,w:56*DPR,h:56*DPR,spd:560*DPR,lives:3,cd:0,weapon:'single',pw:0,ifr:0};
  let score=0,best=+(localStorage.getItem('gb_best')||0), time=0, dt=0, tPrev=0, mode='start', shake=0;

  function reset(){
    stars.length=bullets.length=enemies.length=ebullets.length=powerups.length=sparks.length=0;
    seed=(Date.now()%1e6)|0; time=0; score=0; shake=0;
    Object.assign(player,{x:W()/2,y:H()*0.82,w:56*DPR,h:56*DPR,spd:560*DPR,lives:3,cd:0,weapon:'single',pw:0,ifr:0});
    mkStars(); syncHUD();
  }

  // ---------- Stars (parallax) ----------
  function mkStars(){
    const layers=[
      {n:80,vy:22,sz:[1,2],c:'rgba(180,200,255,.85)'},
      {n:70,vy:44,sz:[1,3],c:'rgba(130,170,255,.7)'},
      {n:60,vy:88,sz:[1,3],c:'rgba(90,120,220,.55)'}
    ];
    for(const L of layers) for(let i=0;i<L.n;i++) stars.push({x:R()*W(),y:R()*H(),vy:L.vy*DPR,r:(L.sz[0]+R()*(L.sz[1]-L.sz[0]))*DPR,c:L.c});
  }
  function drawBG(){
    const bg=IMG.bg; if(bg){ const s=Math.max(W()/bg.width,H()/bg.height); const w=bg.width*s,h=bg.height*s; cx.globalAlpha=0.6; cx.drawImage(bg,(W()-w)/2,(H()-h)/2,w,h); cx.globalAlpha=1; }
    for(const s of stars){ s.y+=s.vy*dt; if(s.y>H()+10){s.y=-10; s.x=R()*W();} cx.beginPath(); cx.fillStyle=s.c; cx.arc(s.x,s.y,s.r,0,6.283); cx.fill(); }
  }

  // ---------- Helpers / FX ----------
  const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
  function puff(x,y,col='rgba(255,210,120,',rad=26,count=20,spd=220){ for(let i=0;i<count;i++){ const a=R()*6.283, sp=90+R()*spd; sparks.push({x,y,vx:Math.cos(a)*sp,vy:Math.sin(a)*sp,t:0,life:.45+R()*.4,c:col,rad}); } shake=Math.min(shake+8,16); }
  function hud(){ scoreP.textContent='Score: '+score; livesP.textContent='♥'.repeat(player.lives); powerP.textContent= player.weapon==='triple'?'Power: Triple':(player.weapon==='shield'?'Power: Shield':'Power: —'); }
  function syncHUD(){ hud(); bestLine.textContent='Best: '+best+' • Tip: Grab powerups!'; }

  // ---------- Spawning ----------
  function spawnWave(){
    const wave = clamp(1+Math.floor(time/10),1,9);
    const n = clamp(4+Math.floor(time/5),4,12);
    for(let i=0;i<n;i++){
      const kind = (R()<0.45)?'meteor':'drone';
      const x=40*DPR+R()*(W()-80*DPR), y=-60*DPR - i*(36*DPR+R()*36*DPR);
      if(kind==='meteor'){
        enemies.push({t:'meteor',x,y,w:48*DPR,h:48*DPR,hp:1+Math.floor(wave/3),vx:(R()-.5)*28*DPR,vy:(90+R()*120)*DPR,a:R()*6.283,spin:R()*2-1});
      }else{
        enemies.push({t:'drone',x,y,w:48*DPR,h:40*DPR,hp:2+Math.floor(wave/2),vx:(R()-.5)*44*DPR,vy:(120+R()*150)*DPR,cd:.9+R()*1.2});
      }
    }
  }
  function maybeBoss(){ if(Math.abs(time-60)<.02){ enemies.push({t:'boss',x:W()/2,y:-140*DPR,w:140*DPR,h:100*DPR,hp:75, vx:0,vy:70*DPR, cd:.4}); } }
  function spawnPU(x,y){ if(R()<.45){ powerups.push({x,y,w:28*DPR,h:28*DPR,kind:(R()<.5?'shield':'triple'),vy:80*DPR}); } }

  // ---------- Update ----------
  function step(){
    dt = Math.min(0.033, dt); // clamp for stability
    time+=dt;
    const left=keys.left||leftTouch, right=keys.right||rightTouch, shoot=keys.shoot||fireTouch;

    const vx=(right?1:0)-(left?1:0);
    player.x=clamp(player.x + vx*player.spd*dt, 28*DPR, W()-28*DPR);
    if(player.ifr>0) player.ifr-=dt;

    player.cd-=dt;
    if(shoot && player.cd<=0){
      const base={x:player.x,y:player.y-28*DPR,w:10*DPR,h:24*DPR,vy:-560*DPR};
      bullets.push({...base});
      if(player.weapon!=='single'){ bullets.push({...base,x:player.x-14*DPR}); bullets.push({...base,x:player.x+14*DPR}); }
      player.cd=(player.weapon==='single')?.14:.2;
      puff(player.x,player.y-26*DPR,'rgba(140,200,255,',18,160);
    }

    // waves & boss
    if(Math.floor((time-dt)/2)!==Math.floor(time/2)) spawnWave();
    maybeBoss();

    for(let i=enemies.length-1;i>=0;i--){ const e=enemies[i];
      e.y+=e.vy*dt; e.x+=e.vx*dt; if(e.spin) e.a+=e.spin*dt;
      if(e.t!=='meteor'){ e.cd-=dt; if(e.cd<=0){ ebullets.push({x:e.x,y:e.y+e.h*.5,w:8*DPR,h:18*DPR,vy:260*DPR}); e.cd=(e.t==='boss')?.25:1.1+R(); } }
      if(e.y-e.h>H()+40) enemies.splice(i,1);
    }
    for(let i=bullets.length-1;i>=0;i--){ const b=bullets[i]; b.y+=b.vy*dt; if(b.y+b.h<-30) bullets.splice(i,1); }
    for(let i=ebullets.length-1;i>=0;i--){ const b=ebullets[i]; b.y+=b.vy*dt; if(b.y-b.h>H()+30) ebullets.splice(i,1); }
    for(let i=powerups.length-1;i>=0;i--){ const p=powerups[i]; p.y+=p.vy*dt; if(p.y-p.h>H()+30) powerups.splice(i,1); }

    // bullets -> enemies
    for(let i=enemies.length-1;i>=0;i--){ const e=enemies[i];
      for(let j=bullets.length-1;j>=0;j--){ const b=bullets[j];
        if(Math.abs(e.x-b.x)*2<(e.w+b.w)&&Math.abs(e.y-b.y)*2<(e.h+b.h)){
          bullets.splice(j,1); e.hp--; puff(b.x,b.y,'rgba(130,180,255,',14,120,180);
          if(e.hp<=0){ score += (e.t==='boss')?800:80; puff(e.x,e.y,'rgba(255,200,120,',36,240,260); spawnPU(e.x,e.y); enemies.splice(i,1); }
          break;
        }
      }
    }

    // hits on player
    const P={x:player.x,y:player.y,w:player.w,h:player.h};
    let hit=false;
    for(let i=ebullets.length-1;i>=0;i--){ const b=ebullets[i];
      if(Math.abs(P.x-b.x)*2<(P.w+b.w)&&Math.abs(P.y-b.y)*2<(P.h+b.h)){ ebullets.splice(i,1); hit=true; }
    }
    for(let i=enemies.length-1;i>=0;i--){ const e=enemies[i];
      if(Math.abs(P.x-e.x)*2<(P.w+e.w)&&Math.abs(P.y-e.y)*2<(P.h+e.h)){ enemies.splice(i,1); hit=true; }
    }
    if(hit && player.ifr<=0){
      if(player.weapon==='shield'){ player.weapon='single'; player.pw=0; puff(P.x,P.y,'rgba(120,220,200,',30,200); }
      else { player.lives--; player.ifr=1.2; puff(P.x,P.y,'rgba(255,120,140,',32,200); shake=14; if(player.lives<=0){ return end(); } }
    }

    // pickups
    for(let i=powerups.length-1;i>=0;i--){ const p=powerups[i];
      if(Math.abs(P.x-p.x)*2<(P.w+p.w)&&Math.abs(P.y-p.y)*2<(P.h+p.h)){
        if(p.kind==='shield'){ player.weapon='shield'; player.pw=10; }
        else { player.weapon='triple'; player.pw=10; }
        powerups.splice(i,1); puff(P.x,P.y-30*DPR,'rgba(140,220,255,',22,160);
      }
    }
    if(player.pw>0){ player.pw-=dt; if(player.pw<=0){ player.weapon='single'; } }

    // sparks (explosions / juice)
    for(let i=sparks.length-1;i>=0;i--){ const s=sparks[i]; s.t+=dt; s.x+=s.vx*dt; s.y+=s.vy*dt; if(s.t>=s.life) sparks.splice(i,1); }

    hud();
  }

  // ---------- Draw ----------
  function draw(){
    const s=shake; if(shake>0) shake=Math.max(0,shake-.85);
    cx.save(); if(s>0) cx.translate((R()-.5)*s*DPR,(R()-.5)*s*DPR);
    cx.clearRect(0,0,W(),H());
    drawBG();

    // player (blink on i-frames)
    if(!(player.ifr>0 && Math.floor(time*20)%2===0)){
      if(IMG.player){ const im=IMG.player; cx.drawImage(im,(player.x-player.w/2)|0,(player.y-player.h/2)|0,player.w,player.h); }
      else { cx.fillStyle='#8bf'; cx.fillRect((player.x-player.w/2)|0,(player.y-player.h/2)|0,player.w,player.h); }
    }

    // bullets
    if(IMG.bullet){ for(const b of bullets) cx.drawImage(IMG.bullet,(b.x-b.w/2)|0,(b.y-b.h/2)|0,b.w,b.h); }
    else { cx.fillStyle='#9df'; for(const b of bullets) cx.fillRect((b.x-b.w/2)|0,(b.y-b.h/2)|0,b.w,b.h); }

    // enemy bullets
    if(IMG.ebullet){ for(const b of ebullets) cx.drawImage(IMG.ebullet,(b.x-b.w/2)|0,(b.y-b.h/2)|0,b.w,b.h); }
    else { cx.fillStyle='#f88'; for(const b of ebullets) cx.fillRect((b.x-b.w/2)|0,(b.y-b.h/2)|0,b.w,b.h); }

    // enemies
    for(const e of enemies){
      if(e.t==='meteor' && IMG.meteor){ cx.save(); cx.translate(e.x,e.y); cx.rotate(e.a||0); cx.drawImage(IMG.meteor,-e.w/2,-e.h/2,e.w,e.h); cx.restore(); }
      else if(IMG.enemy){ cx.drawImage(IMG.enemy,(e.x-e.w/2)|0,(e.y-e.h/2)|0,e.w,e.h); }
      else { cx.fillStyle='#f54'; cx.fillRect((e.x-e.w/2)|0,(e.y-e.h/2)|0,e.w,e.h); }
    }

    // powerups
    cx.fillStyle='#8ff';
    for(const p of powerups){ cx.beginPath(); cx.arc(p.x,p.y,p.w/2,0,6.283); cx.fill(); }

    // sparks / explosions with fade
    for(const s of sparks){ const a=1-(s.t/s.life); cx.fillStyle=s.c + a + ')'; cx.beginPath(); cx.arc(s.x,s.y,(s.rad*(.3+.7*a))|0,0,6.283); cx.fill(); }

    cx.restore();
  }

  // ---------- Loop ----------
  function loop(t){
    dt=Math.min(0.033,(t-tPrev)/1000||0.016); tPrev=t;
    if(mode==='play'){ step(); draw(); }
    requestAnimationFrame(loop);
  }

  // ---------- Flow ----------
  function start(){ startEl.style.display='none'; overEl.style.display='none'; reset(); mode='play'; }
  function end(){ mode='over'; overEl.style.display='grid'; finalLine.textContent='Score: '+score; best=Math.max(best,score); localStorage.setItem('gb_best',best); }
  let paused=false;
  function togglePause(){ paused=!paused; if(paused){ mode='pause'; pauseBtn.textContent='Resume'; } else { mode='play'; pauseBtn.textContent='Pause'; } }

  // hook up UI
  playBtn.onclick=start; againBtn.onclick=()=>{ overEl.style.display='none'; start(); }; pauseBtn.onclick=togglePause;

  // init
  (async function init(){ await loadAssets(); bestLine.textContent='Best: '+best; requestAnimationFrame(loop); })();

})();
</script>
</body>
</html>
